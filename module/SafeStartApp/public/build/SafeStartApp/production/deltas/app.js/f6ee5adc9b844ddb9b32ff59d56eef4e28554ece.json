["/*b5d1fcd4099a951b10d274e09a44d15a1332c1e7",42,602919,"460:6",596777,70,"370:500",598796,34,596888,138,"UserProfile",597034,117,"UserProfileDialog",630656,43,"UserProfile",603405,13498,"additional",616735,36,"titl",601278,60,616967,11202,"currentOdometerKms\",defaultValue:\"unknown",628159,61,"currentOdometerHours\",defaultValue:\"unknown\"",628211,154,"enabled\",defaultValue:1",628356,1134,629701,292,"5",629995,67,"fieldset\",title:\"Current odometer:\",items:[{xtype:\"textfield\",disabled:true,name:\"currentOdometerHours\",label:\"Hours\"},{xtype:\"textfield\",disabled:true,name:\"currentOdometerKms\"",630031,2248,632445,44,";",608560,46,624854,67,614832,52,632428,3605,"b){var j=this,k=[],d",634207,34,"c=this.getChecklistForms(),n=[],h=d",636142,50,",f=d.down(\"field[name=current-odometer-kms]\").getValue(),p=d.down(\"field[name=current-odometer-hours]\").getValue(),a=\"\",m,e,q=d.inspectionRecord,o=\"\",l=[],r;if(h",636206,33,"h.gps){m=h.gps;a=m.getLatitude()+\";\"+m.getLongitude()}Ext.each(d",636307,51,"s){e=s.config.alertModel;k.push({fieldId:parseInt(e.get(\"fieldId\")),comment:e.get(\"comment\"),images:e.get(\"photos\")})});Ext.each(c,function(s){l=s",636512,36,"t){if(t.isHidden()){return}switch(t.xtype){case\"checkboxfield\":if(t",636615,42,"n.push({id:t",636669,56,"t.isChecked()){n.push({id:t.config.fieldId,value:t",636775,36,"n.push({id:t.config.fieldId,value:t",636846,42,"n.push({id:t.config.fieldId,value:t.getValue()});break}})});r={date:Date.now(),fields:n,alerts:k,odometer:f,odometer_hours:p,gps:a};if(q){o=\"?checklistId=\"+q.get(\"checkListId\")}var i=this.getNavMain();var g=",639916,33,";SafeStartApp.AJAX(\"vehicle/\"+d.vehicleId+\"/completechecklist\"+o,r,function(s){d.clearChecklist();d",637166,42,".destroy();var w=i.getActiveItem();var v=d.vehicleId;var t=i.getStore().getNodeById(v+\"-inspections\");var u=i.getStore().getNodeById(v).indexOf(t);g.inspectionsStore.on({load:function(z,y){var x=z.findRecord(\"hash\",s.checklist);g.loadChecklistDetails(x)},single:true});i.fireEvent(\"itemtap\",i,w,u,null,t",637668,864,638816,48,"sPanel\":{editInspection:\"onEditInspectionAction",642377,57,638586,1365,639916,33,640062,33,639949,1715,",onEditInspectionAction:function(c,b,d){var a=this",640399,35,634208,32,");",641466,33,"getchecklist?checklistId=\"+b,{},function(e",634113,46,"e.checklist,c,d);a.loadAlerts(b)})},loadAlert",641309,52,"inspection/\"+b+\"/alerts",634098,47,"fillAlertsData(",649375,33,641692,1903,598351,36,643631,227,",{xtype:\"fieldset\",title:\"Change password:\",items:[{xtype:\"textfield\",name:\"new_password\",label:\"New\"},{xtype:\"textfield\",name:\"confirm_password\",label:\"Confirm\"}]}]",598656,42,643901,686,"Companies",644591,5194,"Companies",649789,1886,"xtype:\"",651646,830,"etStore().loadData()}}]}]);this.getStore().addListener(\"beforeload\",function(){this.goToNode(this.getStore().getRoot())},this",675184,35,641076,33,"\",{extend:",652623,35,652719,6355,681392,39,659114,475,"fieldValueExists:function(b){var d,a,c;for(c=0,a=b.length;c<a;c++){d=b[c];switch(d.type){case\"group\":if(this.fieldValueExists(d.items)){return true}break;default:if(Ext.isString(d.fieldValue)&&d.fieldValue.length){return true}break}}return false},clearChecklist:function(){this.inspectionRecord=null",659635,35,673824,42,"a){this.remove(a)},this)},fillAlertsData:function(b){var a=this.getAlertsStore();var c;Ext.each(b,function(d){c=a.findRecord(\"fieldId\",d.field.id);if(c){c.set(\"photos\",d.images);c.set(\"comment\",d.description)}})},loadChecklist:function(a,e,g){var d=this;var f=[],h=[],b=[];this.clearChecklist();this.vehicleId=e||0;this.isNew=!g;this.inspectionRecord=g;a=a||[];var c={painted:function(i){d",634618,38,"this",634657,41,"this.config.checked}};Ext.each(a,function(k,j){var i=this.createForm(k,j);if(k.additional){i",659833,34,"h.push(i",659875,38,"k.groupName,checked:this.isNew?false:this.fieldValueExists(k.fields),checklistGroupId:k.groupId,listeners:this.isNew?{}:c})}else{i.name=\"checklist-card\";f.push(i)}},this);this.add(f);if(b.length){this.add(this.createChoiseAdditionalCard(b))}this.add(h);this.add(this.createReviewCard())},createChoiseAdditionalCard:function(a){return",660484,40,660075,137,"a},",660600,38,"A",660281,180,"},createReviewCard:function(){return",660484,335,"},createForm:function(c,b){var d=[];if(b!==0){d.push({text:\"Prev\",action:\"prev\"})}d.push({text:\"Next\",action:\"next\"});var a=this.createFields(c",660870,53,"c",660924,120,"d",661101,97,"c.groupId,additional:c.additional,groupName:c",661243,967,"value:a.fieldValue",662209,94,"if(e&&RegExp(e.get(\"triggerValue\"),\"i\").test(b.fieldValue)){e.set(\"active\",true)}Ext.each(b.options,function(f){var g=b.fieldValue||\"n/a\";",662334,102,"new RegExp(f.value,\"i\").test(g),listeners:{check:function(h){var i=h.getValue();h",662508,42,"i",662551,360,"if(i){if(RegExp(i.get(\"triggerValue\"),\"i\").test(h",662980,40,"DANGER",663029,348,"RegExp(this.config.triggerValue,\"i\").test(h",663425,49,663504,452,"a.fieldValue||Date.now()",663956,40,"if(c&&RegExp(c.get(\"triggerValue\"),\"i\").test(a.fieldValue)){c.set(\"active\",true)}",663996,190,"checked:a.fieldValue==\"yes\"",664185,208,"if(RegExp(g.get(\"triggerValue\",\"i\").test(f",664477,41,"DANGER",664527,348,"RegExp(this.config.triggerValue,\"i\").test(f",664923,418,"AdditionalFields",665348,43,"AdditionalFields:function(){var a=1000,b=0;if(!this.isNew&&this.inspectionRecord){a=this.inspectionRecord.get(\"odometerKms\");b=this.inspectionRecord.get(\"odometerHours\")}return[",665416,159,"h,f,d,g,e){var c=h",665593,52,"g){if(!c.gps){c",665660,46,",{xtype:\"container\",name:\"vehicle-inspection-additional-fields\",width:\"100%\",maxWidth:900,height:\"auto",646464,35,"urrent odometer\",layout:{type:\"vbox\"},width:\"100%\",items:[{xtype:\"spinnerfield\",name:\"current-odometer-kms\",label:\"Kilometers\",stepValue:1000,required:true,value:a,minValue:1000},{xtype:\"spinnerfield\",name:\"current-odometer-hours\",label:\"Hours\",stepValue:24,value:b,minValue:0}]}]}]",665706,2517,451033,35,"var a=this;this.uniqueId=Ext.id();this.callParent();this.add(",668229,35,"+this.uniqueId",668264,39,668377,257,"+this.uniqueId",668634,375,"+this.uniqueId",669009,48,"+this.uniqueId",669057,289,"+this.uniqueId",669346,64,"button\",text:\"Delete\",name:\"delete-data",630235,76,"AlertPanel\").deleteAction(",619151,116,669514,39,")",669565,96,"+this.uniqueId).setData(b.data);this.setComments(this.record.raw.comments",669766,37,669679,33,"Images\"+this.uniqueId).show();",669803,63,"+this.uniqueId",669866,61,"else{",669679,33,"Images\"+this.uniqueId).hide()}",669679,33,"Status\"+this.uniqueId",669967,177,"+this.uniqueId",670144,71,"+this.uniqueId",670215,132,"if(a.new_comment!=\"\"){",670347,136,"}b.setComments(b.record.raw.comments);b",670175,40,"+b.uniqueId).setValue(\"\")})},setComments:function(a){if(a.length",669824,35,"Comments\"+this.uniqueId).show(",669677,44,"+this.uniqueId).setData({comments:a})}else{",669679,42,"+this.uniqueId).hide()}",614448,106,"aler",624634,33,"\"vehicle/alert/\"+a.record.get(\"id\")+\"/delete\",{},function(b){a.getParent().pop();a.getParent().alertsStore.loadData()}",649376,43,670664,2576,"ry{this",671696,35,673278,189,"catch(a){}",670624,53,673519,1426,"mod",659117,34,605547,34,"checkListId\",type:\"int\"",627856,38,"creationDate\",type:\"datetime\",mapping:\"creation_date\"},{name:\"data\",type:\"auto\"},{name:\"gps\",type:\"string\"},{name:\"id\",type:\"number\"},{name:\"hash\",type:\"string\"},{name:\"odometerHours\",type:\"integer\",mapping:\"odometer_hours\"},{name:\"odometerKms\",type:\"integer\",mapping:\"odometer_kms",596079,59,667633,60,"VehicleInspection",653390,78,"VehicleInspection\",proxy:{type:\"ajax",679248,155,675225,442,675687,139,"a){var b",641328,35,"a.get(\"checkListId\")",675870,36,"b.createView(c,d.checklist,a)},true,true)},createView:function(g,f,a){console.log(f,a);var d=[],b=g.responsibleUsers().first(),h",676003,90,"d",676094,44,"g",676139,59,"g.get(\"projectName\")));if(b){d",676228,44,"b.getFullName()))}d",676291,43,"f.creationDate.date));if(f.gpsCoords){h=f.gpsCoords.split(\";\");d",676398,53,"h[0]),parseFloat(h[1])))}this.createGroup(d",676494,50,"\",g",676560,39,"Registration\",g.get(\"registration",676573,43,"g.get(\"type\")),]);var e=g.get(\"serviceDueKm\")+\" km \"+g",676669,33,"var c=\"\";if(a.get(\"odometerKms\")){c+=a.get(\"odometerKms\")+\" km\"}if(a.get(\"odometerHours\")){c+=\" \"+a.get(\"odometerHours\")+\" hours\"}",676496,40,"Service due\",e",676756,42,"c)]);this.createButtons(f.id);this.checkListId=f.id;this.vehicleId=g.get(\"id\");this.inspectionRecord=a;Ext.each(f.fieldsStructure,function(i){this.createFields(i.fields,f.fieldsData,f.alerts,i",676909,47,"b,c,d){var a=d?\"sfa-vehicle-details-container-alert\":\"sfa-vehicle-details-container\";return{xtype:\"container\",cls:a",677312,104,"b",677417,34,"container\",html:c",677188,1118,"f",678305,35,"h){var g=false;switch(h",678351,44,"h.items,c,f,h",678406,70,"f,function(i){if(i.field.id==h.fieldId){g=true}},this);Ext.each(c,function(i){if(i.id==h",678500,38,"h.fieldName,i.value,g",678557,54,"j){if(j.id==h.fieldId){if(j.value){var i=new Date(j",678662,36,"h.fieldName,Ext.Date.format(i,\"Y-m-d",678740,38,"h",678779,303,659103,34,670682,61,"Inspection",670748,80,"items:[{name:\"edit-inspection\",align:\"right\",hidden:true,text:\"Edit\",handler:function(c){var a=c.up(",680423,34,");var b=a.down(\"",639056,34,");var e=b.checkListId;var d=b.vehicleId;a.fireEvent(\"editInspection\",d,e,b.inspectionRecord)}},{name:\"delete-inspection\",align:\"right\",hidden:true,text:\"Delete\",handler:function(a){console.log(\"Delete inspection handler\"",671751,41,"changeButtons(b)},pop:function(a,b){this.changeButtons(a)},back:function(){this.hideButton",671840,52,"inspectionsStore",640816,39,"Inspections\");this.inspectionsStore.getProxy().setUrl(\"/api/vehicle/1/getinspection",671940,76,"[{xtype:\"list\",name:\"vehicle-inspections\",disableSelection:true,title:\"Vehicle Inspections\",emptyText:\"No Inspections\",itemTpl:\"{title}\",cls:\"sfa-inspections\",store:this.inspections",621206,34,"e,c,d,b){a.onSelectInspectionAction(e,c,d,b)}}}]",672385,41,".get(\"id\");this.vehicle=b;this.inspectionsStore.getProxy().setUrl(\"/api/vehicle/\"+this.vehicleId+\"/getinspections\");this.inspectionsStore.loadData();this.removeChecklistDetails()},onSelectInspectionAction:function(d,b,c,a){this.loadChecklistDetails(a)},loadChecklistDetails:function(a){if(this.inspectionView){this.inspectionView.destroy()}this.inspectionView",682512,37,675225,33,"title:\"Inspection\"});this.hideButtons();this.push(this.inspectionView);this.inspectionView.loadChecklist(this.vehicle,a)},removeChecklistDetails:function(){var a=this.down(\"",639056,34,");if(a){this.pop(a);this.hideButtons()}},changeButtons:function(a){switch(a.xtype){case",680423,34,":break;case\"",639056,34,":this.down(\"button[name=edit-inspection]\").show(true);this.down(\"button[name=delete-inspection]\").show(true);break}},hideButtons:function(){this.down(\"button[name=edit-inspection]\").hide(true);this.down(\"button[name=delete-inspection]\").hide(true)",644942,35,679088,63,"defaultRootId:0",679165,10212,689642,1278]